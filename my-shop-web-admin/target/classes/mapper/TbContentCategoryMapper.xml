<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hz.my.shop.web.admin.dao.TbContentCategoryDao" >
    <sql id="tbContentCategoryColumns" >
         a.id,
         a.parent_id as parentId,
         a.name,
         a.status,
         a.sort_order as sortOrder,
         a.is_parent as isParent,
         a.created,
         a.updated
    </sql>

    <sql id="tbContentCategoryJoins">
        LEFT JOIN tb_content_category AS b ON a.parent_id = b.id
    </sql>

    <select id="selectAll" resultType="tbContentCategory">
        SELECT <include refid="tbContentCategoryColumns"/>
        FROM tb_content_category as a ORDER BY a.parent_id asc ,a.sort_order asc,a.is_parent desc;
    </select>

    <!--根据父id查询结果，返回到控制层通过递归处理得到内容分类的树形结果-->
    <select id="selectByPid" resultType="tbContentCategory">
        SELECT <include refid="tbContentCategoryColumns"/>
        FROM tb_content_category as a
        where a.parent_id = #{parentId}
    </select>

    <select id="getById" resultType="TbContentCategory">
        SELECT
        <include refid="tbContentCategoryColumns"/>
        FROM
        tb_content_category AS a
        <include refid="tbContentCategoryJoins"/>
        WHERE a.id = #{id}
    </select>
</mapper>